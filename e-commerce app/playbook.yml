-
  name: Deploy e-commerce app
  hosts: all
  tasks:
    - name: Install firewallD
      yum:
        name: firewalld
        state: present

    - name: Start firewallD service
      service:
        name: firewalld
        state: started

    - name: Enable systemctl firewallD
      systemd:
        name: firewalld
        enabled: yes

    - name: Install mariadb-server
      become: yes
      yum:
        name: mariadb-server
        state: present

    - name: Start mariadb service
      become: yes
      service:
        name: mariadb
        state: started

    - name: Enable systemctl mariadb
      become: yes
      systemd:
        name: mariadb
        enabled: yes

    - name: Add port db to firewall
      become: yes
      firewalld:
        port: 3306/tcp
        permanent: yes
        zone: public
        state: enabled

    - name: Reload service firewalld
      become: yes
      service:
        name: firewalld
        state: reloaded

    - name: Install MySQL-python
      become: yes
      yum:
        name: MySQL-python
        state: present

    - name: Create a new databse
      mysql_db:
        name: ecomdb
        login_host: localhost
        state: present

    - name: Create admin database user
      mysql_user:
        name: ecomuser
        host: localhost
        password: ecompassword
        priv: '*.*:ALL'
        state: present
